// ============================================================================
// ESCROWBASE DATABASE SCHEMA
// ============================================================================
// 
// SECURITY ARCHITECTURE:
// ----------------------
// This schema follows a "Zero PII" principle for banking data.
// 
// ❌ WE DO NOT STORE:
//    - Bank account numbers
//    - Routing numbers  
//    - Full SSNs
//    - Any data that could be used for unauthorized wire transfers
//
// ✅ WE DO STORE:
//    - Bridge.xyz tokenized IDs (e.g., "ext_acct_abc123")
//    - Non-sensitive metadata (names, types, amounts)
//    - Our own internal reference IDs
//
// WHY THIS MATTERS:
// If our database is ever breached, attackers get NOTHING useful.
// They cannot initiate wire transfers with just a Bridge beneficiary ID.
// The actual bank details are encrypted and stored by Bridge.xyz,
// a SOC 2 Type II compliant financial infrastructure provider.
//
// ============================================================================

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================================================
// USER / AUTH
// ============================================================================

model User {
  id            String    @id @default(cuid())
  
  // Coinbase Smart Wallet address (public, not sensitive)
  walletAddress String    @unique
  
  // Display name (optional, user-provided)
  displayName   String?
  
  // Email for notifications (optional)
  email         String?
  
  // Role-based access
  role          UserRole  @default(ESCROW_OFFICER)
  
  // Timestamps
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  lastLoginAt   DateTime?
  
  // Relations
  escrows       Escrow[]
  
  @@index([walletAddress])
}

enum UserRole {
  ESCROW_OFFICER
  ADMIN
  VIEWER
}

// ============================================================================
// ESCROW
// ============================================================================

model Escrow {
  id              String       @id @default(cuid())
  
  // Human-readable escrow ID (e.g., "ESC-2024-001847")
  escrowId        String       @unique
  
  // Qualia integration - File Number for cross-reference
  qualiaFileNumber String?     @unique
  
  // Property details (non-sensitive)
  propertyAddress String
  city            String
  state           String
  zipCode         String
  purchasePrice   Decimal      @db.Decimal(18, 2)
  
  // Buyer info (for wiring instructions)
  buyerFirstName  String
  buyerLastName   String
  buyerEmail      String
  
  // Expected closing date (from Qualia import or manual entry)
  closingDate     DateTime?
  
  // ══════════════════════════════════════════════════════════════════════════
  // BRIDGE.XYZ TOKENIZED REFERENCES (Compliant Architecture)
  // ══════════════════════════════════════════════════════════════════════════
  // 
  // NON-COMMINGLING COMPLIANCE:
  // Each escrow gets its own segregated custodial wallet via Bridge's 
  // Wallet-as-a-Service. Funds for "Deal A" never touch "Deal B".
  //
  // NO MONEY TRANSMISSION:
  // We NEVER hold private keys. Bridge is the Qualified Custodian.
  // All funds are held in Bridge-controlled custodial wallets.
  //
  // ══════════════════════════════════════════════════════════════════════════
  
  // Bridge Customer ID (represents the Buyer for KYC purposes)
  bridgeCustomerId        String?
  
  // Segregated Custodial Wallet ID (unique per deal - NON-COMMINGLING)
  bridgeWalletId          String?
  
  // On-chain wallet address (for the segregated wallet)
  bridgeWalletAddress     String?
  
  // Virtual Account ID (for receiving wire/ACH deposits)
  bridgeVirtualAccountId  String?
  
  // On-chain references (public blockchain data, not sensitive)
  vaultAddress    String?      // Smart contract address on Base
  safeAddress     String?      // Gnosis Safe multisig address
  
  // Status tracking
  status          EscrowStatus @default(CREATED)
  
  // Financial tracking (we track amounts, not bank details)
  initialDeposit  Decimal?     @db.Decimal(18, 6)  // Initial USDB deposited
  currentBalance  Decimal?     @db.Decimal(18, 6)  // Current USDB balance (includes yield)
  
  // ══════════════════════════════════════════════════════════════════════════
  // APPROVAL SETTINGS
  // ══════════════════════════════════════════════════════════════════════════
  // Escrow officer can choose how many approvals are required to close:
  // - requiredApprovals = 1 → Single approval (just the primary officer)
  // - requiredApprovals = 2+ → Multi-approval (additional signers required)
  // ══════════════════════════════════════════════════════════════════════════
  requiredApprovals Int        @default(1)  // Number of signatures required to close
  
  // ══════════════════════════════════════════════════════════════════════════
  // YIELD SETTINGS
  // ══════════════════════════════════════════════════════════════════════════
  // Buyer can choose whether to earn yield on their escrowed funds.
  // - yieldEnabled = true  → Use USDB (yield-earning stablecoin)
  // - yieldEnabled = false → Use USDC (standard stablecoin, no yield)
  // ══════════════════════════════════════════════════════════════════════════
  yieldEnabled    Boolean      @default(true)  // true = USDB (yield), false = USDC (no yield)
  
  // ══════════════════════════════════════════════════════════════════════════
  // YIELD TRACKING (Only applies if yieldEnabled = true)
  // ══════════════════════════════════════════════════════════════════════════
  // LEGAL REQUIREMENT: 100% of yield MUST go to the buyer (depositor).
  // Neither EscrowPayi nor the Escrow Agent can keep any yield.
  // We track this to ensure full compliance at escrow close.
  // ══════════════════════════════════════════════════════════════════════════
  yieldEarned     Decimal?     @db.Decimal(18, 6)  // Yield accrued (currentBalance - initialDeposit)
  yieldReturnedTo String?      // "BUYER" - confirms yield was returned to depositor
  
  // Transaction hashes (public blockchain data)
  depositTxHash   String?
  closeTxHash     String?
  
  // Timestamps
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  fundedAt        DateTime?
  closedAt        DateTime?
  
  // Relations
  createdBy       User         @relation(fields: [createdById], references: [id])
  createdById     String
  payees          Payee[]
  signers         EscrowSigner[]
  activityLogs    ActivityLog[]
  wireBatches     WireBatch[]
  
  @@index([escrowId])
  @@index([status])
  @@index([createdById])
}

// ============================================================================
// ESCROW SIGNERS (Multi-Approval Support)
// ============================================================================
//
// When requiredApprovals > 1, additional signers must be configured.
// Each signer must have a valid Coinbase Wallet address.
// The primary escrow officer (createdBy) is always the first signer.
//
// ============================================================================

model EscrowSigner {
  id            String       @id @default(cuid())
  
  // Signer identification
  walletAddress String       // Coinbase Wallet address (required for signing)
  displayName   String?      // Optional friendly name (e.g., "John - Supervisor")
  email         String?      // For notifications
  role          String       @default("Approver")  // e.g., "Supervisor", "Manager", "Co-Officer"
  
  // Signer order (1 = primary officer, 2+ = additional signers)
  signerOrder   Int          @default(1)
  
  // Signing status for current close transaction
  hasSigned     Boolean      @default(false)
  signedAt      DateTime?
  
  // Timestamps
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  
  // Relations
  escrow        Escrow       @relation(fields: [escrowId], references: [id], onDelete: Cascade)
  escrowId      String
  
  @@unique([escrowId, walletAddress])  // Each wallet can only be a signer once per escrow
  @@index([escrowId])
  @@index([walletAddress])
}

enum EscrowStatus {
  CREATED           // Escrow opened, awaiting funds
  DEPOSIT_PENDING   // Wire initiated, not yet received
  FUNDS_RECEIVED    // USDC received in Safe, ready for payee setup
  READY_TO_CLOSE    // All payees configured, ready for disbursement
  CLOSING           // Close transaction in progress
  CLOSED            // All funds disbursed
  CANCELLED         // Escrow cancelled
}

// ============================================================================
// PAYEE (TOKENIZED BANK REFERENCES)
// ============================================================================
// 
// ⚠️  CRITICAL SECURITY DESIGN ⚠️
// 
// This table stores REFERENCES to bank accounts, NOT the actual bank data.
// 
// The `bridgeBeneficiaryId` is a token issued by Bridge.xyz when we submit
// the payee's bank details through their secure API. Bridge stores the
// actual routing/account numbers in their PCI-compliant, SOC 2 vault.
//
// WHAT HAPPENS WHEN WE ADD A PAYEE:
// 1. User enters: Name, Bank Name, Routing #, Account #
// 2. We POST to Bridge.xyz /external_accounts
// 3. Bridge returns: { id: "ext_acct_abc123", ... }
// 4. We store ONLY the id in `bridgeBeneficiaryId`
// 5. We IMMEDIATELY DISCARD the routing/account numbers
// 6. They are NEVER written to our database or logs
//
// WHAT HAPPENS WHEN WE PAY A PAYEE:
// 1. We call Bridge.xyz POST /transfers with the beneficiary_id
// 2. Bridge looks up the actual bank details in THEIR vault
// 3. Bridge initiates the wire/ACH
// 4. We never see the bank details again
//
// ============================================================================

model Payee {
  id              String       @id @default(cuid())
  
  // ══════════════════════════════════════════════════════════════════════════
  // SAFE TO STORE: Non-sensitive identifiers
  // ══════════════════════════════════════════════════════════════════════════
  firstName       String
  lastName        String
  email           String?
  
  // Payee classification (for reporting, not security-sensitive)
  payeeType       PayeeType
  
  // ══════════════════════════════════════════════════════════════════════════
  // TOKENIZED BANK REFERENCE (Bridge.xyz)
  // ══════════════════════════════════════════════════════════════════════════
  // This is the ONLY banking reference we store.
  // Format: "ext_acct_xxxxxxxxxxxx" 
  // This token is USELESS without Bridge.xyz API credentials.
  // Even if stolen, an attacker cannot:
  //   - Retrieve the bank account number
  //   - Retrieve the routing number
  //   - Initiate transfers (requires our API key + webhook verification)
  // ══════════════════════════════════════════════════════════════════════════
  bridgeBeneficiaryId  String
  
  // ══════════════════════════════════════════════════════════════════════════
  // SAFE TO STORE: Non-sensitive bank metadata
  // ══════════════════════════════════════════════════════════════════════════
  // We store the bank NAME for display purposes only.
  // This is public information (you can Google any bank's name).
  bankName        String?
  
  // Last 4 digits of account (for user verification UI)
  // This is standard practice and not sufficient for fraud.
  accountLast4    String?
  
  // ══════════════════════════════════════════════════════════════════════════
  // USDC DIRECT PAYMENT (for crypto-native payees)
  // ══════════════════════════════════════════════════════════════════════════
  // Wallet address for direct USDC transfers on Base
  // This is a public blockchain address, not sensitive data.
  walletAddress   String?
  
  // Payment method preference
  paymentMethod   PaymentMethod
  
  // ══════════════════════════════════════════════════════════════════════════
  // FINANCIAL DATA (amounts, not bank details)
  // ══════════════════════════════════════════════════════════════════════════
  amount          Decimal?     @db.Decimal(18, 2)  // Fixed amount
  basisPoints     Int?         // Percentage of purchase price (e.g., 300 = 3%)
  
  // Status
  status          PayeeStatus  @default(PENDING)
  
  // Bridge transfer reference (for tracking payout)
  bridgeTransferId    String?
  
  // Timestamps  
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  paidAt          DateTime?
  
  // Relations
  escrow          Escrow       @relation(fields: [escrowId], references: [id], onDelete: Cascade)
  escrowId        String
  
  @@index([escrowId])
  @@index([bridgeBeneficiaryId])
  @@index([status])
}

enum PayeeType {
  // Primary Parties
  BUYER
  SELLER
  // Real Estate Agents
  BUYER_AGENT           // Buyer's Agent (Selling Agent)
  LISTING_AGENT         // Seller's Agent (Listing Agent)
  // Lenders & Mortgage
  BUYER_LENDER          // Buyer's Lender (if financed)
  LOAN_OFFICER          // Loan Officer / Mortgage Broker
  MORTGAGE_PAYOFF       // Mortgage Payoff (Seller's Existing Loan)
  HELOC_LENDER          // HELOC Lender (if applicable)
  // Title & Escrow
  ESCROW_COMPANY        // Escrow Officer / Escrow Company
  TITLE_INSURANCE       // Title Insurance Company
  UNDERWRITER           // Underwriter (Lender Side)
  // Appraisal
  APPRAISER             // Appraiser
  APPRAISAL_MGMT        // Appraisal Management Company
  // Insurance & Warranty
  HOME_INSURANCE        // Homeowners Insurance Company
  HOME_WARRANTY         // Home Warranty Company (if applicable)
  // Transaction Support
  NOTARY                // Notary Public / Mobile Notary
  TC_BUYER              // Transaction Coordinator (Buyer Side)
  TC_SELLER             // Transaction Coordinator (Seller Side)
  COURIER_SERVICE       // Courier / Wire / Recording Service Providers
  // HOA / Condo
  HOA                   // HOA / Condo Association (if applicable)
  HOA_MGMT              // HOA Management Company
  // Liens & Payoffs
  LIEN_HOLDER           // Other Lien Holders (Tax, Judgment, Mechanics, etc.)
  // Government
  PROPERTY_TAX          // Property Tax Authority
  COUNTY_RECORDER       // County Recorder
  // Other Services
  HAZARD_DISCLOSURE     // Natural Hazard Disclosure Provider (state-dependent)
  CREDIT_AGENCY         // Credit Reporting Agency (indirect, lender-related)
  OTHER                 // Other
}

enum PaymentMethod {
  USDC          // Direct USDC transfer on Base (instant)
  WIRE          // Domestic wire transfer
  ACH           // ACH transfer (slower, cheaper)
  INTERNATIONAL // International wire (SWIFT)
  CHECK         // Physical check
}

enum PayeeStatus {
  PENDING       // Not yet processed
  QUEUED        // Queued for payout
  PROCESSING    // Bridge is processing
  COMPLETED     // Funds sent
  FAILED        // Transfer failed
}

// ============================================================================
// ACTIVITY LOG (Audit Trail)
// ============================================================================

model ActivityLog {
  id          String   @id @default(cuid())
  
  // What happened
  action      String   // e.g., "PAYEE_ADDED", "ESCROW_CLOSED"
  details     Json?    // Additional context (NO sensitive data)
  
  // Who did it
  actorWallet String?  // Wallet address that performed action
  actorIp     String?  // IP address (for security auditing)
  
  // Timestamps
  createdAt   DateTime @default(now())
  
  // Relations
  escrow      Escrow   @relation(fields: [escrowId], references: [id], onDelete: Cascade)
  escrowId    String
  
  @@index([escrowId])
  @@index([createdAt])
}

// ============================================================================
// ESCROW COMPANY (KYB - Know Your Business)
// ============================================================================
//
// ⚠️  CRITICAL SECURITY DESIGN ⚠️
//
// This table tracks escrow companies that have been onboarded via Bridge.xyz.
// Bridge handles all KYB verification and compliance.
//
// ❌ WE DO NOT STORE:
//    - EIN/Tax ID numbers (after initial submission to Bridge)
//    - SSNs of beneficial owners
//    - Driver's license or ID document data
//    - Any PII that could be used for identity theft
//
// ✅ WE DO STORE:
//    - Bridge.xyz customer ID (tokenized reference)
//    - Company name and public business info
//    - KYB status from Bridge
//    - Officer names (public info, not sensitive)
//
// ============================================================================

model EscrowCompany {
  id                  String              @id @default(cuid())
  
  // ══════════════════════════════════════════════════════════════════════════
  // BRIDGE.XYZ TOKENIZED REFERENCES
  // ══════════════════════════════════════════════════════════════════════════
  // Bridge Customer ID for this business
  bridgeCustomerId    String              @unique
  
  // ══════════════════════════════════════════════════════════════════════════
  // COMPANY INFORMATION (Non-sensitive, public business data)
  // ══════════════════════════════════════════════════════════════════════════
  companyName         String
  businessEmail       String
  website             String?
  
  // Business address (public, not sensitive)
  streetLine1         String
  streetLine2         String?
  city                String
  state               String
  postalCode          String
  country             String              @default("USA")
  
  // ══════════════════════════════════════════════════════════════════════════
  // KYB STATUS TRACKING
  // ══════════════════════════════════════════════════════════════════════════
  // We track the status from Bridge webhooks
  kybStatus           KybStatus           @default(PENDING)
  kybCompletedAt      DateTime?
  rejectionReasons    String[]            @default([])
  
  // ══════════════════════════════════════════════════════════════════════════
  // TIMESTAMPS
  // ══════════════════════════════════════════════════════════════════════════
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  
  // Relations
  officers            EscrowOfficer[]
  
  @@index([bridgeCustomerId])
  @@index([kybStatus])
  @@index([companyName])
}

enum KybStatus {
  PENDING           // Initial state, awaiting KYC link completion
  UNDER_REVIEW      // Documents submitted, Bridge is reviewing
  APPROVED          // Fully approved, can create virtual accounts
  REJECTED          // KYB failed, see rejectionReasons
  INCOMPLETE        // Missing information, needs more data
}

// ============================================================================
// ESCROW OFFICER (Associated Person / UBO)
// ============================================================================
//
// Officers are associated with an Escrow Company.
// Bridge requires at least one Control Person for business customers.
//
// ❌ WE DO NOT STORE:
//    - SSN (collected via Bridge's hosted KYC link)
//    - Driver's license data
//    - Date of birth (after initial submission)
//
// ============================================================================

model EscrowOfficer {
  id                  String              @id @default(cuid())
  
  // ══════════════════════════════════════════════════════════════════════════
  // BRIDGE.XYZ REFERENCES
  // ══════════════════════════════════════════════════════════════════════════
  // Associated Person ID from Bridge
  bridgePersonId      String?
  
  // ══════════════════════════════════════════════════════════════════════════
  // OFFICER INFORMATION (Non-sensitive)
  // ══════════════════════════════════════════════════════════════════════════
  firstName           String
  lastName            String
  email               String?
  title               String              // e.g., "Owner", "Director", "CEO"
  
  // Control person / UBO designation
  isControlPerson     Boolean             @default(true)
  ownershipPercentage Int?                // Percentage of ownership (if UBO)
  
  // ══════════════════════════════════════════════════════════════════════════
  // KYC STATUS (for individual officer verification)
  // ══════════════════════════════════════════════════════════════════════════
  kycStatus           KycStatus           @default(NOT_STARTED)
  kycLink             String?             // Bridge hosted KYC link
  tosLink             String?             // Bridge TOS acceptance link
  kycCompletedAt      DateTime?
  
  // ══════════════════════════════════════════════════════════════════════════
  // WALLET (for platform access)
  // ══════════════════════════════════════════════════════════════════════════
  walletAddress       String?             // Coinbase Wallet for signing in
  
  // ══════════════════════════════════════════════════════════════════════════
  // TIMESTAMPS
  // ══════════════════════════════════════════════════════════════════════════
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  
  // Relations
  company             EscrowCompany       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId           String
  
  @@unique([companyId, email])
  @@index([companyId])
  @@index([bridgePersonId])
  @@index([walletAddress])
}

enum KycStatus {
  NOT_STARTED       // KYC link not yet visited
  PENDING           // KYC link sent, awaiting completion
  UNDER_REVIEW      // Documents submitted, Bridge reviewing
  APPROVED          // Identity verified
  REJECTED          // Verification failed
}

// ============================================================================
// WIRE BATCH (Qualia File Bridge Integration)
// ============================================================================
//
// Tracks batch wire/ACH files imported from Qualia for processing via Bridge.xyz
//
// WORKFLOW:
// 1. UPLOADED:   Escrow officer uploads NACHA/CSV file (Maker)
// 2. PENDING:    Awaiting approval from second officer (Checker)
// 3. APPROVED:   Second officer approved, ready for execution
// 4. PROCESSING: Bridge.xyz payouts in progress
// 5. COMPLETED:  All payouts executed successfully
// 6. FAILED:     One or more payouts failed (partial success possible)
// 7. REJECTED:   Checker rejected the batch
//
// ============================================================================

model WireBatch {
  id                String          @id @default(cuid())
  
  // ══════════════════════════════════════════════════════════════════════════
  // BATCH IDENTIFICATION
  // ══════════════════════════════════════════════════════════════════════════
  batchId           String          @unique  // e.g., "WB-2026-001234"
  
  // Original file information
  fileName          String                   // Original uploaded file name
  fileType          String                   // 'nacha' or 'csv'
  fileSize          Int                      // File size in bytes
  fileHash          String?                  // SHA-256 hash for integrity verification
  
  // ══════════════════════════════════════════════════════════════════════════
  // BATCH STATUS & WORKFLOW
  // ══════════════════════════════════════════════════════════════════════════
  status            WireBatchStatus @default(UPLOADED)
  
  // ══════════════════════════════════════════════════════════════════════════
  // FINANCIAL SUMMARY
  // ══════════════════════════════════════════════════════════════════════════
  totalItems        Int                      // Number of payees in batch
  totalAmount       Decimal         @db.Decimal(18, 2)  // Total USD amount
  
  // Breakdown by payment rail
  wireCount         Int             @default(0)  // Items routed via Fedwire (>$100k)
  wireTotal         Decimal         @default(0) @db.Decimal(18, 2)
  rtpCount          Int             @default(0)  // Items routed via RTP (≤$100k)
  rtpTotal          Decimal         @default(0) @db.Decimal(18, 2)
  
  // Execution results
  successCount      Int?                     // Successfully processed items
  failedCount       Int?                     // Failed items
  skippedCount      Int?                     // Skipped items (missing data)
  
  // ══════════════════════════════════════════════════════════════════════════
  // BRIDGE.XYZ REFERENCES
  // ══════════════════════════════════════════════════════════════════════════
  // Source wallet for payouts
  bridgeWalletId    String?
  sourceCurrency    String          @default("usdb")  // 'usdb' or 'usdc'
  
  // ══════════════════════════════════════════════════════════════════════════
  // DUAL CONTROL (MAKER/CHECKER)
  // ══════════════════════════════════════════════════════════════════════════
  // Maker: Officer who uploaded the file
  makerWallet       String                   // Wallet address of uploader
  makerName         String?                  // Display name
  uploadedAt        DateTime        @default(now())
  
  // Checker: Officer who approved/rejected
  checkerWallet     String?                  // Wallet address of approver
  checkerName       String?                  // Display name
  reviewedAt        DateTime?
  reviewNotes       String?                  // Reason for approval/rejection
  
  // ══════════════════════════════════════════════════════════════════════════
  // EXECUTION DETAILS
  // ══════════════════════════════════════════════════════════════════════════
  executedAt        DateTime?
  completedAt       DateTime?
  
  // JSON storage for parsed items and results
  parsedItems       Json?                    // Array of ParsedPayoutItem
  executionResults  Json?                    // Array of PayoutResult
  
  // ══════════════════════════════════════════════════════════════════════════
  // RECONCILIATION
  // ══════════════════════════════════════════════════════════════════════════
  reconciliationGenerated Boolean  @default(false)
  reconciliationDownloadedAt DateTime?
  
  // ══════════════════════════════════════════════════════════════════════════
  // TIMESTAMPS
  // ══════════════════════════════════════════════════════════════════════════
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  
  // ══════════════════════════════════════════════════════════════════════════
  // RELATIONS
  // ══════════════════════════════════════════════════════════════════════════
  // Optional: Link to a specific escrow if batch is for a single deal
  escrow            Escrow?         @relation(fields: [escrowId], references: [id])
  escrowId          String?
  
  @@index([batchId])
  @@index([status])
  @@index([makerWallet])
  @@index([uploadedAt])
}

enum WireBatchStatus {
  UPLOADED          // File uploaded, awaiting review
  PENDING           // Under review by checker
  APPROVED          // Approved, ready to execute
  PROCESSING        // Execution in progress
  COMPLETED         // All payouts successful
  PARTIAL           // Some payouts succeeded, some failed
  FAILED            // All payouts failed
  REJECTED          // Checker rejected the batch
  CANCELLED         // Maker cancelled before approval
}

// ============================================================================
// END OF SCHEMA
// ============================================================================
//
// SECURITY CHECKLIST:
// ✅ No routing numbers stored
// ✅ No account numbers stored
// ✅ No SSNs stored
// ✅ No EINs stored (after Bridge submission)
// ✅ No credit card numbers stored
// ✅ Only Bridge.xyz tokenized IDs for banking
// ✅ Audit trail for all actions
// ✅ Role-based access control
//
// ============================================================================
